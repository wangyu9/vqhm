mA1=...
    @(p1,p2,p3)p2.*2.0+sqrt(p1);

mA2=...
    @(p1,p2,p3)p3.*2.0;

mA3=...
    @(p1,p2,p3)p2.*-2.0+sqrt(p1);

s_dAdP11=...
    @(p1,p2,p3)1.0./sqrt(p1)./2.0;

s_dAdP12=...
    @(p1,p2,p3)2.0;

s_dAdP13=...
    @(p1,p2,p3)0.0;

s_dAdP21=...
    @(p1,p2,p3)0.0;

s_dAdP22=...
    @(p1,p2,p3)0.0;

s_dAdP23=...
    @(p1,p2,p3)2.0;

s_dAdP31=...
    @(p1,p2,p3)1.0./sqrt(p1)./2.0;

s_dAdP32=...
    @(p1,p2,p3)-2.0;

s_dAdP33=...
    @(p1,p2,p3)0.0;

nA1=...
    @(p1,p2,p3)(p2.*2.0-sqrt(p1))./(-p1+p2.^2.*4.0+p3.^2.*4.0);

nA2=...
    @(p1,p2,p3)(p3.*2.0)./(-p1+p2.^2.*4.0+p3.^2.*4.0);

nA3=...
    @(p1,p2,p3)-(p2.*2.0+sqrt(p1))./(-p1+p2.^2.*4.0+p3.^2.*4.0);

t_dAdP11=...
    @(p1,p2,p3)(1.0./sqrt(p1).*(-1.0./2.0))./(-p1+p2.^2.*4.0+p3.^2.*4.0)+(p2.*2.0-sqrt(p1)).*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2;

t_dAdP12=...
    @(p1,p2,p3)2.0./(-p1+p2.^2.*4.0+p3.^2.*4.0)-p2.*(p2.*2.0-sqrt(p1)).*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2.*8.0;

t_dAdP13=...
    @(p1,p2,p3)p3.*(p2.*2.0-sqrt(p1)).*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2.*-8.0;

t_dAdP21=...
    @(p1,p2,p3)p3.*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2.*2.0;

t_dAdP22=...
    @(p1,p2,p3)p2.*p3.*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2.*-1.6e+1;

t_dAdP23=...
    @(p1,p2,p3)p3.^2.*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2.*-1.6e+1+2.0./(-p1+p2.^2.*4.0+p3.^2.*4.0);

t_dAdP31=...
    @(p1,p2,p3)(1.0./sqrt(p1).*(-1.0./2.0))./(-p1+p2.^2.*4.0+p3.^2.*4.0)-(p2.*2.0+sqrt(p1)).*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2;

t_dAdP32=...
    @(p1,p2,p3)-2.0./(-p1+p2.^2.*4.0+p3.^2.*4.0)+p2.*(p2.*2.0+sqrt(p1)).*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2.*8.0;

t_dAdP33=...
    @(p1,p2,p3)p3.*(p2.*2.0+sqrt(p1)).*1.0./(-p1+p2.^2.*4.0+p3.^2.*4.0).^2.*8.0;